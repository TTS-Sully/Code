##########################################################################################################################
### Tech Team Solutions NuGet, WinGet, PowerShell, and Windows Update for Powershell Installation Script
### Last Updated 2025.05.16
### Written by ESS
##########################################################################################################################

##########################################################################################################################
### Install Microsoft NuGet
##########################################################################################################################

Write-Host "Installing NuGet and then the newest version of powershell."
Install-PackageProvider -Name NuGet -MinimumVersion 2.8.5.201 -Force

##########################################################################################################################
### Install Microsoft Powershell
##########################################################################################################################

Install-Module -Name PowerShellGet -Force

##########################################################################################################################
### Install Microsoft WinGet
##########################################################################################################################

Write-Host "Installing Operation packages..."
Install-Module -Name Microsoft.WinGet.Client -RequiredVersion 0.2.1 -Force
Write-Host "WinGet installed"

##########################################################################################################################
### Install Microsoft Windows Update for PowerShell
##########################################################################################################################

Install-Module PSWindowsUpdate
Import-Module PSWindowsUpdate